---
import { Icon } from "astro-icon/components";
import HeaderBanner2 from "../components/HeaderBanner2.astro";
import RootLayout from "../layouts/RootLayout.astro";
import ContactUsBanner from "../components/ContactUsBanner.astro";
---

<RootLayout
  title="Contact Us | Cepticon Limited"
  description="B-MESON Limited is a leading recruitment and talent acquisition firm committed to connecting exceptional talent with ambitious organizations."
  keywords="Contact Recruitment Agency, Recruitment Services, Job Inquiries, Employment Opportunities, Hiring Assistance, Get In Touch, Request Talent, Submit Resume, Career Assistance, Employer Services, Recruitment Support, Job Vacancies Inquiry, Speak With Us, Reach Out"
>
  <HeaderBanner2 route="Contact Us" />
  <section class="container mx-auto px-4 py-10 lg:py-20">
    <h2
      class="relative text-3xl lg:text-4xl text-center font-poppins uppercase font-bold text-primary"
    >
      Get In Touch
    </h2>
    <hr
      class="w-[70px] mx-auto bg-primary h-1 mb-4 lg:mb-8 mt-2 rounded-full"
    />
    <section class="grid gap-8 grid-cols-1 md:grid-cols-2 lg:grid-cols-3">
      <div
        class="bg-primary rounded-lg shadow-md shadow-primary text-center px-4 lg:px-6 py-8 flex flex-col items-center gap-4"
      >
        <div class="p-4 bg-orange-500 rounded-full">
          <Icon name={"phone"} size={30} class="text-white" />
        </div>
        <h3 class="text-orange-500 text-xl font-bold font-poppins">Call</h3>
        <div class="grid place-items-center gap-2">
          <p class="font-bold text-lg text-white text-center font-inter">
            +234 (0) 901 971 4692
          </p>
        </div>
      </div>
      <div
        class="bg-primary rounded-lg shadow-md shadow-primary text-center px-4 lg:px-6 py-8 flex flex-col items-center gap-4"
      >
        <div class="p-4 bg-orange-500 rounded-full">
          <Icon name={"email"} size={30} class="text-white" />
        </div>
        <h3 class="text-orange-500 text-xl font-bold font-poppins">Email</h3>
        <div class="grid place-items-center gap-2">
          <p class="font-bold text-lg text-white text-center font-inter">
            info.bmeson@gmail.com
          </p>
          <p class="font-bold text-lg text-white text-center font-inter">
            info@b-meson.com.ng
          </p>
        </div>
      </div>
      <div
        class="bg-primary rounded-lg shadow-md shadow-primary text-center px-4 lg:px-6 py-8 flex flex-col items-center gap-4"
      >
        <div class="p-4 bg-orange-500 rounded-full">
          <Icon name={"location"} size={30} class="text-white" />
        </div>
        <h3 class="text-orange-500 text-xl font-bold font-poppins">Visit</h3>
        <p class="font-bold text-lg text-white text-center font-inter">
          3/5 Charity Road, New Oko Oba, Lagos, Nigeria
        </p>
      </div>
    </section>

    <ContactUsBanner />

    <!-- Contact Form -->
    <section class="bg-white grid grid-cols-1 lg:grid-cols-2 gap-8 mt-10">
      <div class="relative w-full pb-[56.25%]">
        <iframe
          src="https://www.google.com/maps/embed?pb=!1m16!1m12!1m3!1d15852.019467268681!2d3.2969011793444682!3d6.646315743571515!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!2m1!1s3%2F5%20Charity%20road%2C%20New%20Oko%20Oba%2C%20Lagos%2C%20Nigeria!5e0!3m2!1sen!2sng!4v1737003564979!5m2!1sen!2sng"
          class="absolute top-0 left-0 w-full h-full border-0"
          allowfullscreen=""
          loading="lazy"
          referrerpolicy="no-referrer-when-downgrade"></iframe>
      </div>
      <div class="px-8 py-6 shadow-md">
        <form id="contactusForm" method="POST">
          <h2
            class="text-xl lg:text-3xl text-center lg:text-left font-poppins uppercase font-bold mb-4 text-primary"
          >
            Send a message
          </h2>
          <form action="https://formspree.io/f/xjkveloz" method="POST">
            <div class="mb-4">
              <label for="name" class="block text-primary font-bold mb-2"
                >Name</label
              >
              <input
                type="text"
                id="name"
                name="name"
                placeholder="Enter your name"
                class="input-field"
                required
                aria-required="true"
              />
              <p class="error-message hidden" id="error-fullName">
                Name is required.
              </p>
            </div>
            <div class="mb-4">
              <label for="email" class="block font-bold text-primary mb-2"
                >Email</label
              >
              <input
                type="email"
                id="email"
                name="email"
                placeholder="Enter your email address"
                class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-primary focus:border-blue-500"
                required
              />
            </div>
            <div class="mb-4">
              <label for="phone" class="block text-primary font-bold mb-2"
                >Phone Number</label
              >
              <input
                type="tel"
                id="phone"
                name="phone"
                placeholder="Enter your phone number"
                class="input-field"
                required
                aria-required="true"
              />
              <p class="error-message hidden" id="error-phone">
                Phone Number is required.
              </p>
            </div>
            <div class="mb-4">
              <label for="message" class="block font-bold text-primary mb-2"
                >Message</label
              >
              <textarea
                id="message"
                name="message"
                rows="4"
                class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-primary focus:border-blue-500"
                required></textarea>
            </div>
            <div class="flex items-center justify-between">
              <button
                type="submit"
                id="submitForm"
                class="bg-primary w-full hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
                aria-label="Submit"
              >
                Submit
              </button>
            </div>
            <div
              id="error-message"
              class="w-full bg-red-700 text-white p-4 rounded-lg text-center mt-4 hidden"
            >
              An error occurred while submitting the form.
            </div>
          </form>
        </form>
      </div>
    </section>
  </section>

  <script>
    import { actions, isInputError } from "astro:actions";
    import { navigate } from "astro:transitions/client";

    const form = document.querySelector("form");
    const submitButton = document.getElementById(
      "submitForm"
    ) as HTMLButtonElement;

    form?.addEventListener("submit", async (event) => {
      event.preventDefault();

      // Disable the submit button and change its text
      submitButton.disabled = true;
      submitButton.textContent = "Submitting data...";

      const formData = new FormData(form);
      const { error } = await actions.contact(formData);
      const inputs = form.querySelectorAll(".input-field");

      if (isInputError(error)) {
        // Handle input errors
        inputs.forEach((input) => {
          const errorElement = document.getElementById(`error-${input.id}`);
          if (error.fields[input.id]) {
            const message = error.fields[input.id].join(", ");
            errorElement.textContent = message;
            errorElement.classList.remove("hidden");
          } else {
            errorElement.classList.add("hidden");
            input.classList.remove("border-red-500");
          }
        });
        // Re-enable the button if there's an error
        submitButton.disabled = false;
        submitButton.textContent = "Submit";
      }

      if (error) {
        submitButton.disabled = false;
        submitButton.textContent = "Submit";
        const errorMessageElement = document.getElementById("error-message");
        errorMessageElement.classList.remove("hidden");

        setTimeout(() => {
          errorMessageElement.classList.add("hidden");
        }, 3000);
      } else {
        // Navigate to success page if no error
        navigate("/thankyou");
      }
    });
  </script>

  <style>
    .input-field {
      border: 1px solid #ddd;
      padding: 0.5rem;
      width: 100%;
      border-radius: 0.375rem;
      transition: border-color 0.2s ease;
    }

    .input-field:focus {
      outline: none;
      border-color: #4caf50;
      box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.3);
    }

    .error-message {
      color: red;
      font-size: 0.875rem;
      margin-top: 0.25rem;
    }

    .hidden {
      display: none;
    }

    .border-red-500 {
      border-color: red !important;
    }

    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }
  </style>
</RootLayout>
